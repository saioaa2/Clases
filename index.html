<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Horario semanal</title>
  <style>
    :root {
      --bg: #f3f4f6;             /* fondo general */
      --primary: #2563eb;        /* azul principal */
      --primary-light: #3b82f6;
      --secondary: #dbeafe;      /* azul muy suave para "hoy" */
      --accent: #9333ea;         /* violeta para detalles */
      --muted: #6b7280;
      --line: #e5e7eb;
      --event-student: #10b981;  /* verde */
      --event-own: #f59e0b;      /* naranja */
      --event-other: #8b5cf6;    /* violeta */
    }

    body {
      margin:0;
      font-family:"Inter", "Segoe UI", Roboto, sans-serif;
      background:var(--bg);
      color:#111827;
    }

    /* ===== CABECERA ===== */
    header {
      position: sticky;
      top: 0;
      z-index: 50;
      background:white;
      border-bottom:1px solid var(--line);
      padding:1.25rem 1.75rem;
      box-shadow:0 2px 8px rgba(0,0,0,.05);
      display:flex;
      flex-direction:column;
      gap:1rem;
    }

    header h1 {
      margin:0;
      font-size:1.9rem;
      font-weight:700;
      color:var(--primary);
      letter-spacing:-0.5px;
    }

    header .controls {
      display:flex;
      flex-wrap:wrap;
      align-items:center;
      gap:.75rem 1.25rem;
    }

    header button {
      background:var(--primary);
      color:white;
      border:none;
      padding:.5rem 1.1rem;
      border-radius:.6rem;
      cursor:pointer;
      font-weight:500;
      font-size:.9rem;
      transition: background .2s ease, transform .15s ease;
    }

    header button:hover {
      background:var(--primary-light);
      transform:translateY(-1px);
    }

    header label {
      font-size:.85rem;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:.4rem;
    }

    header input, header select {
      border:1px solid var(--line);
      border-radius:.5rem;
      padding:.35rem .6rem;
      font-size:.85rem;
      background:white;
      transition:border .2s ease;
    }

    header input:focus, header select:focus {
      border-color:var(--primary-light);
      outline:none;
      box-shadow:0 0 0 2px rgba(37,99,235,.15);
    }

    /* ===== CALENDARIO ===== */
    .calendar {
      display:grid;
      grid-template-columns:80px repeat(7, 1fr);
      grid-template-rows:55px auto;
      overflow-x:auto;
      background:white;
      border:1px solid var(--line);
      border-radius:.9rem;
      margin:1.25rem;
      box-shadow:0 4px 12px rgba(0,0,0,.05);
    }

    .day-header { display:contents; }

    .day-header .cell {
      padding:.9rem .25rem;
      text-align:center;
      font-weight:600;
      font-size:.95rem;
      border-bottom:1px solid var(--line);
      color:#374151;
    }

    .day-header .today {
      background:var(--secondary);
      border-radius:.6rem;
      color:#1e3a8a;
    }

    .grid { display:contents; }

    .grid .cell {
      border:1px solid var(--line);
      box-sizing:border-box;
      background:#fff;
    }

    .grid .hour {
      text-align:right;
      padding-right:.6rem;
      font-size:.8rem;
      color:var(--muted);
      background:#f9fafb;
      font-weight:500;
    }

    /* ===== EVENTOS ===== */
    .event {
      padding:.45rem .55rem;
      border-radius:.65rem;
      font-size:.85rem;
      box-shadow:0 2px 6px rgba(0,0,0,.1);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      justify-content:center;
      animation: fadeIn .35s ease;
    }

    .event .title {
      font-weight:600;
      margin-bottom:2px;
    }

    .event .meta {
      font-size:.75rem;
      opacity:.9;
    }

    /* Colores de eventos */
    .cat-clase { background: linear-gradient(135deg, var(--event-other), #a78bfa); color:white; }
    .tu-clase { background: linear-gradient(135deg, var(--event-own), #fcd34d); color:#1f2937; }
    .alumno-clase { background: linear-gradient(135deg, var(--event-student), #34d399); color:white; }

    /* Animación */
    @keyframes fadeIn {
      from { opacity:0; transform: translateY(5px); }
      to { opacity:1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <header>
    <h1 id="headerTitle">Horario semanal</h1>
    <div class="controls">
      <button id="prev">◀ Semana anterior</button>
      <button id="today">Hoy</button>
      <button id="next">Semana siguiente ▶</button>
      <label>Ir a fecha <input id="goDate" type="date" /></label>
      <label>Inicio <select id="startHour"></select></label>
      <label>Fin <select id="endHour"></select></label>
      <label><input id="toggleWeekend" type="checkbox" checked /> Mostrar fin de semana</label>
    </div>
  </header>

<!-- Calendario -->
<div id="calendarRoot"></div>

<!-- Botón para abrir Excel (abajo del calendario) -->
<div id="excelButtonContainer" style="margin-top:10px;"></div>

<!-- Aquí aparecerá el Excel cuando pulses el botón -->
<div id="excelContent" style="margin-top:20px;"></div>

  <main class="calendar" id="calendarRoot">
    <div id="dayHeader" class="day-header"></div>
    <div id="grid" class="grid"></div>
  </main>

  <script>

    const CLASES = [
      { date: "2025-09-22", start: "09:00", end: "14:00" },
      { date: "2025-09-23", start: "09:00", end: "14:00" },
      { date: "2025-09-23", start: "20:30", end: "21:30" },
      { date: "2025-09-24", start: "09:00", end: "14:00" },
      { date: "2025-09-24", start: "15:00", end: "18:30" },
      { date: "2025-09-25", start: "09:00", end: "14:00" },
      { date: "2025-09-25", start: "15:00", end: "18:30" },
      { date: "2025-09-25", start: "20:00", end: "21:30" },
      { date: "2025-09-26", start: "09:00", end: "14:00" },
      { date: "2025-09-29", start: "09:00", end: "14:00" },
      { date: "2025-09-30", start: "09:00", end: "14:00" },
      { date: "2025-09-30", start: "20:30", end: "21:30" },
      { date: "2025-10-01", start: "09:00", end: "14:00" },
      { date: "2025-10-02", start: "09:00", end: "14:00" },
      { date: "2025-10-02", start: "20:00", end: "21:30" },
      { date: "2025-10-03", start: "09:00", end: "14:00" },
      { date: "2025-10-06", start: "09:00", end: "14:00" },
      { date: "2025-10-07", start: "09:00", end: "14:00" },
      { date: "2025-10-07", start: "20:30", end: "21:30" },
      { date: "2025-10-08", start: "09:00", end: "14:00" },
      { date: "2025-10-09", start: "09:00", end: "14:00" },
      { date: "2025-10-09", start: "20:00", end: "21:30" },
      { date: "2025-10-10", start: "09:00", end: "14:00" },
      { date: "2025-10-13", start: "09:00", end: "14:00" },
      { date: "2025-10-14", start: "09:00", end: "14:00" },
      { date: "2025-10-14", start: "20:30", end: "21:30" },
      { date: "2025-10-15", start: "09:00", end: "14:00" },
      { date: "2025-10-16", start: "09:00", end: "14:00" },
      { date: "2025-10-16", start: "20:00", end: "21:30" },
      { date: "2025-10-17", start: "09:00", end: "14:00" },
      { date: "2025-10-20", start: "09:00", end: "14:00" },
      { date: "2025-10-21", start: "09:00", end: "14:00" },
      { date: "2025-10-21", start: "20:30", end: "21:30" },
      { date: "2025-10-22", start: "09:00", end: "14:00" },
      { date: "2025-10-23", start: "09:00", end: "14:00" },
      { date: "2025-10-23", start: "20:00", end: "21:30" },
      { date: "2025-10-24", start: "09:00", end: "14:00" },
      { date: "2025-10-27", start: "09:00", end: "14:00" },
      { date: "2025-10-28", start: "09:00", end: "14:00" },
      { date: "2025-10-28", start: "20:30", end: "21:30" },
      { date: "2025-10-29", start: "09:00", end: "14:00" },
      { date: "2025-10-30", start: "09:00", end: "14:00" },
      { date: "2025-10-30", start: "20:00", end: "21:30" },
      { date: "2025-10-31", start: "09:00", end: "14:00" },
      { date: "2025-11-10", start: "09:00", end: "21:00" },
      { date: "2025-11-11", start: "09:00", end: "21:00" },
      { date: "2025-11-12", start: "09:00", end: "21:00" },
      { date: "2025-11-13", start: "09:00", end: "21:00" },
      { date: "2025-11-14", start: "09:00", end: "21:00" },
      { date: "2025-11-17", start: "09:00", end: "21:00" },
      { date: "2025-11-18", start: "09:00", end: "21:00" },
      { date: "2025-11-19", start: "09:00", end: "21:00" },
      { date: "2025-11-20", start: "09:00", end: "21:00" },
      { date: "2025-11-21", start: "09:00", end: "21:00" },
      { date: "2025-11-24", start: "09:00", end: "19:30" },
      { date: "2025-11-25", start: "09:00", end: "14:00" },
      { date: "2025-11-25", start: "20:30", end: "21:30" },
      { date: "2025-11-26", start: "09:00", end: "19:30" },
      { date: "2025-12-01", start: "09:00", end: "14:00" },
      { date: "2025-12-02", start: "09:00", end: "19:30" },
      { date: "2025-12-02", start: "20:30", end: "21:30" },
      { date: "2025-12-03", start: "09:00", end: "14:00" },
      { date: "2025-12-04", start: "09:00", end: "19:30" },
      { date: "2025-12-04", start: "20:00", end: "21:30" },
      { date: "2025-12-09", start: "09:00", end: "14:00" },
      { date: "2025-12-09", start: "20:30", end: "21:30" },
      { date: "2025-12-10", start: "09:00", end: "14:00" },
      { date: "2025-12-11", start: "09:00", end: "19:30" },
      { date: "2025-12-11", start: "20:00", end: "21:30" },
      { date: "2025-12-15", start: "09:00", end: "19:30" },
      { date: "2025-12-16", start: "09:00", end: "14:00" },
      { date: "2025-12-16", start: "20:30", end: "21:30" },
      { date: "2025-12-17", start: "09:00", end: "19:30" },
      { date: "2025-12-18", start: "09:00", end: "14:00" },
      { date: "2025-12-18", start: "20:00", end: "21:30" },
      { date: "2026-01-07", start: "09:00", end: "14:00" },
      { date: "2026-01-08", start: "09:00", end: "19:30" },
      { date: "2026-01-08", start: "20:00", end: "21:30" },
      { date: "2026-01-09", start: "09:00", end: "14:00" },
      { date: "2026-01-12", start: "09:00", end: "19:30" },
      { date: "2026-01-13", start: "20:30", end: "21:30" },
      { date: "2026-01-14", start: "09:00", end: "19:30" },
      { date: "2026-01-15", start: "09:00", end: "14:00" },
      { date: "2026-01-26", start: "09:00", end: "19:30" },
      { date: "2026-01-27", start: "09:00", end: "14:00" },
      { date: "2026-01-27", start: "20:30", end: "21:30" },
      { date: "2026-01-29", start: "09:00", end: "14:00" },
      { date: "2026-01-29", start: "20:30", end: "21:30" },
      { date: "2026-01-30", start: "09:00", end: "14:00" },
      { date: "2026-02-02", start: "09:00", end: "19:30" },
      { date: "2026-02-03", start: "09:00", end: "19:30" },
      { date: "2026-02-03", start: "20:30", end: "21:30" },
      { date: "2026-02-05", start: "09:00", end: "14:00" },
      { date: "2026-02-05", start: "20:30", end: "21:30" },
      { date: "2026-02-06", start: "09:00", end: "14:00" },
      { date: "2026-02-09", start: "09:00", end: "19:30" },
      { date: "2026-02-10", start: "09:00", end: "19:30" },
      { date: "2026-02-10", start: "20:30", end: "21:30" },
      { date: "2026-02-12", start: "09:00", end: "14:00" },
      { date: "2026-02-12", start: "20:30", end: "21:30" },
      { date: "2026-02-13", start: "09:00", end: "14:00" },
      { date: "2026-02-16", start: "09:00", end: "19:30" },
      { date: "2026-02-17", start: "09:00", end: "19:30" },
      { date: "2026-02-17", start: "20:30", end: "21:30" },
      { date: "2026-02-19", start: "09:00", end: "14:00" },
      { date: "2026-02-19", start: "20:30", end: "21:30" },
      { date: "2026-02-20", start: "09:00", end: "14:00" },
      { date: "2026-02-24", start: "15:00", end: "19:30" },
      { date: "2026-02-24", start: "20:30", end: "21:30" },
      { date: "2026-02-25", start: "09:00", end: "14:00" },
      { date: "2026-02-26", start: "09:00", end: "14:00" },
      { date: "2026-02-26", start: "20:30", end: "21:30" },
      { date: "2026-03-02", start: "09:00", end: "14:00" },
      { date: "2026-03-03", start: "09:00", end: "19:30" },
      { date: "2026-03-03", start: "20:30", end: "21:30" },
      { date: "2026-03-05", start: "09:00", end: "14:00" },
      { date: "2026-03-05", start: "20:30", end: "21:30" },
      { date: "2025-03-10", start: "09:00", end: "19:30" },
      { date: "2026-03-10", start: "20:30", end: "21:30" },
      { date: "2026-03-12", start: "09:00", end: "14:00" },
      { date: "2026-03-12", start: "20:30", end: "21:30" },
      { date: "2026-03-24", start: "20:30", end: "21:30" },
      { date: "2026-03-26", start: "09:00", end: "14:00" },
      { date: "2026-03-26", start: "20:30", end: "21:30" },
      { date: "2026-03-27", start: "09:00", end: "14:00" },
      { date: "2026-04-09", start: "09:00", end: "14:00" },
      { date: "2026-04-09", start: "20:30", end: "21:30" },
      { date: "2026-04-13", start: "09:00", end: "14:00" },
      { date: "2026-04-14", start: "09:00", end: "14:00" },
      { date: "2026-04-14", start: "20:30", end: "21:30" },
      { date: "2026-04-15", start: "09:00", end: "14:00" },
      { date: "2026-04-16", start: "09:00", end: "14:00" },
      { date: "2026-04-16", start: "20:30", end: "21:30" },
      { date: "2026-04-17", start: "09:00", end: "14:00" },
      { date: "2026-04-20", start: "09:00", end: "14:00" },
      { date: "2026-04-21", start: "09:00", end: "14:00" },
      { date: "2026-04-21", start: "20:30", end: "21:30" },
      { date: "2026-04-22", start: "09:00", end: "14:00" },
      { date: "2026-04-23", start: "09:00", end: "14:00" },
      { date: "2026-04-23", start: "20:30", end: "21:30" },
      { date: "2026-04-24", start: "09:00", end: "14:00" },
      { date: "2026-04-27", start: "09:00", end: "14:00" },
      { date: "2026-04-28", start: "09:00", end: "14:00" },
      { date: "2026-04-28", start: "20:30", end: "21:30" },
      { date: "2026-04-29", start: "09:00", end: "14:00" },
      { date: "2026-04-30", start: "20:30", end: "21:30" },
      { date: "2026-05-04", start: "09:00", end: "14:00" },
      { date: "2026-05-05", start: "09:00", end: "14:00" },
      { date: "2026-05-05", start: "20:30", end: "21:30" },
      { date: "2026-05-06", start: "09:00", end: "14:00" },
      { date: "2026-05-07", start: "09:00", end: "14:00" },
      { date: "2026-05-07", start: "20:30", end: "21:30" },
      { date: "2026-05-08", start: "09:00", end: "14:00" },
      { date: "2026-05-11", start: "09:00", end: "14:00" },
      { date: "2026-05-12", start: "09:00", end: "14:00" },
      { date: "2026-05-12", start: "20:30", end: "21:30" },
      { date: "2026-05-13", start: "09:00", end: "14:00" },
      { date: "2026-05-14", start: "09:00", end: "14:00" },
      { date: "2026-05-14", start: "20:30", end: "21:30" },
      { date: "2026-05-18", start: "09:00", end: "14:00" },
      { date: "2026-05-19", start: "09:00", end: "14:00" },
      { date: "2026-05-19", start: "20:30", end: "21:30" },
      { date: "2026-05-20", start: "09:00", end: "14:00" },
      { date: "2026-05-21", start: "09:00", end: "14:00" },
      { date: "2026-05-21", start: "20:30", end: "21:30" },
      { date: "2026-05-22", start: "09:00", end: "14:00" },

      // Jorge
      { date: "2025-09-17", start: "18:00", end: "19:00" },

      // adriana
      { date: "2025-09-17", start: "19:00", end: "20:00" },
      { date: "2025-09-24", start: "19:00", end: "20:00" },
      { date: "2025-10-01", start: "19:00", end: "20:00" },
      { date: "2025-10-08", start: "19:00", end: "20:00" },
      { date: "2025-10-15", start: "19:00", end: "20:00" },
      { date: "2025-10-22", start: "19:00", end: "20:00" },
      { date: "2025-10-29", start: "19:00", end: "20:00" },
      { date: "2025-11-05", start: "19:00", end: "20:00" },
      { date: "2025-12-03", start: "19:00", end: "20:00" },
      { date: "2025-12-10", start: "19:00", end: "20:00" },
      { date: "2026-01-07", start: "19:00", end: "20:00" },
      { date: "2026-01-21", start: "19:00", end: "20:00" },
      { date: "2026-01-28", start: "19:00", end: "20:00" },
      { date: "2026-02-04", start: "19:00", end: "20:00" },
      { date: "2026-02-11", start: "19:00", end: "20:00" },
      { date: "2026-02-18", start: "19:00", end: "20:00" },
      { date: "2026-02-25", start: "19:00", end: "20:00" },
      { date: "2026-03-04", start: "19:00", end: "20:00" },
      { date: "2026-03-11", start: "19:00", end: "20:00" },
      { date: "2026-03-18", start: "19:00", end: "20:00" },
      { date: "2026-03-25", start: "19:00", end: "20:00" },
      { date: "2026-04-15", start: "19:00", end: "20:00" },
      { date: "2026-04-22", start: "19:00", end: "20:00" },
      { date: "2026-04-29", start: "19:00", end: "20:00" },
      { date: "2026-05-06", start: "19:00", end: "20:00" },
      { date: "2026-05-13", start: "19:00", end: "20:00" },
      { date: "2026-05-20", start: "19:00", end: "20:00" },
      { date: "2026-05-27", start: "19:00", end: "20:00" },

      // noa
        { date: "2025-09-16", start: "16:00", end: "17:30" },
        { date: "2025-09-23", start: "16:00", end: "17:30" },
        { date: "2025-09-30", start: "16:00", end: "17:30" },
        { date: "2025-10-07", start: "16:00", end: "17:30" },
        { date: "2025-10-14", start: "16:00", end: "17:30" },
        { date: "2025-10-21", start: "16:00", end: "17:30" },
        { date: "2025-10-28", start: "16:00", end: "17:30" },
        { date: "2025-11-25", start: "16:00", end: "17:30" },
        { date: "2025-12-05", start: "16:00", end: "17:30" },
        { date: "2025-12-09", start: "16:00", end: "17:30" },
        { date: "2025-12-16", start: "16:00", end: "17:30" },
        { date: "2026-01-13", start: "16:00", end: "17:30" },
        { date: "2026-01-27", start: "16:00", end: "17:30" },
        { date: "2026-02-06", start: "16:00", end: "17:30" },
        { date: "2026-02-13", start: "16:00", end: "17:30" },
        { date: "2026-02-20", start: "16:00", end: "17:30" },
        { date: "2026-02-27", start: "16:00", end: "17:30" },
        { date: "2026-03-06", start: "16:00", end: "17:30" },
        { date: "2026-03-13", start: "16:00", end: "17:30" },
        { date: "2026-03-17", start: "16:00", end: "17:30" },
        { date: "2026-03-24", start: "16:00", end: "17:30" },
        { date: "2026-04-14", start: "16:00", end: "17:30" },
        { date: "2026-04-21", start: "16:00", end: "17:30" },
        { date: "2026-04-28", start: "16:00", end: "17:30" },
        { date: "2026-05-05", start: "16:00", end: "17:30" },
        { date: "2026-05-12", start: "16:00", end: "17:30" },
        { date: "2026-05-19", start: "16:00", end: "17:30" },
        { date: "2026-05-26", start: "16:00", end: "17:30" },

      // paula y carla
      { date: "2025-09-15", start: "18:30", end: "19:30" },
      { date: "2025-09-18", start: "18:30", end: "19:30" },
      { date: "2025-09-22", start: "18:30", end: "19:30" },        
      { date: "2025-09-25", start: "18:30", end: "19:30" },
      { date: "2025-09-29", start: "18:30", end: "19:30" },
      { date: "2025-10-02", start: "18:30", end: "19:30" },
      { date: "2025-10-06", start: "18:30", end: "19:30" },
      { date: "2025-10-09", start: "18:30", end: "19:30" },
      { date: "2025-10-13", start: "18:30", end: "19:30" },
      { date: "2025-10-16", start: "18:30", end: "19:30" },
      { date: "2025-10-20", start: "18:30", end: "19:30" },
      { date: "2025-10-23", start: "18:30", end: "19:30" },
      { date: "2025-10-27", start: "18:30", end: "19:30" },
      { date: "2025-10-30", start: "18:30", end: "19:30" },
      { date: "2025-11-03", start: "18:30", end: "19:30" },
      { date: "2025-11-06", start: "18:30", end: "19:30" },
      { date: "2025-11-27", start: "18:30", end: "19:30" },
      { date: "2025-12-01", start: "18:30", end: "19:30" },
      { date: "2025-12-08", start: "18:30", end: "19:30" },
      { date: "2025-12-18", start: "18:30", end: "19:30" },
      { date: "2026-01-15", start: "18:30", end: "19:30" },
      { date: "2026-01-19", start: "18:30", end: "19:30" },
      { date: "2026-01-22", start: "18:30", end: "19:30" },
      { date: "2026-01-29", start: "18:30", end: "19:30" },
      { date: "2026-02-05", start: "18:30", end: "19:30" },
      { date: "2026-02-12", start: "18:30", end: "19:30" },
      { date: "2026-02-19", start: "18:30", end: "19:30" },
      { date: "2026-02-23", start: "18:30", end: "19:30" },
      { date: "2026-02-26", start: "18:30", end: "19:30" },
      { date: "2026-03-02", start: "18:30", end: "19:30" },
      { date: "2026-03-05", start: "18:30", end: "19:30" },
      { date: "2026-03-09", start: "18:30", end: "19:30" },
      { date: "2026-03-12", start: "18:30", end: "19:30" },
      { date: "2026-03-16", start: "18:30", end: "19:30" },
      { date: "2026-03-19", start: "18:30", end: "19:30" },
      { date: "2026-03-23", start: "18:30", end: "19:30" },
      { date: "2026-03-26", start: "18:30", end: "19:30" },
      { date: "2026-04-09", start: "18:30", end: "19:30" },
      { date: "2026-04-13", start: "18:30", end: "19:30" },
      { date: "2026-04-16", start: "18:30", end: "19:30" },
      { date: "2026-04-20", start: "18:30", end: "19:30" },
      { date: "2026-04-23", start: "18:30", end: "19:30" },
      { date: "2026-04-27", start: "18:30", end: "19:30" },
      { date: "2026-04-30", start: "18:30", end: "19:30" },
      { date: "2026-05-04", start: "18:30", end: "19:30" },
      { date: "2026-05-07", start: "18:30", end: "19:30" },
      { date: "2026-05-11", start: "18:30", end: "19:30" },
      { date: "2026-05-14", start: "18:30", end: "19:30" },
      { date: "2026-05-18", start: "18:30", end: "19:30" },
      { date: "2026-05-21", start: "18:30", end: "19:30" },
      { date: "2026-05-25", start: "18:30", end: "19:30" },
      { date: "2026-05-28", start: "18:30", end: "19:30" },

      // lea

        { date: "2025-09-15", start: "16:15", end: "17:15" },
        { date: "2025-09-18", start: "17:15", end: "18:15" },
        { date: "2025-09-22", start: "16:15", end: "17:15" },
        { date: "2025-09-26", start: "16:15", end: "17:15" },
        { date: "2025-09-29", start: "16:15", end: "17:15" },
        { date: "2025-10-02", start: "17:15", end: "18:15" },
        { date: "2025-10-06", start: "16:15", end: "17:15" },
        { date: "2025-10-09", start: "17:15", end: "18:15" },
        { date: "2025-10-13", start: "16:15", end: "17:15" },
        { date: "2025-10-16", start: "17:15", end: "18:15" },
        { date: "2025-10-20", start: "16:15", end: "17:15" },
        { date: "2025-10-23", start: "17:15", end: "18:15" },
        { date: "2025-10-27", start: "16:15", end: "17:15" },
        { date: "2025-10-30", start: "17:15", end: "18:15" },
        { date: "2025-11-03", start: "16:15", end: "17:15" },
        { date: "2025-11-06", start: "17:15", end: "18:15" },
        { date: "2025-11-27", start: "17:15", end: "18:15" },
        { date: "2025-12-01", start: "16:15", end: "17:15" },
        { date: "2025-12-12", start: "16:15", end: "17:15" },
        { date: "2025-12-18", start: "17:15", end: "18:15" },
        { date: "2026-01-09", start: "16:15", end: "17:15" },
        { date: "2026-01-15", start: "17:15", end: "18:15" },
        { date: "2026-01-19", start: "16:15", end: "17:15" },
        { date: "2026-01-22", start: "17:15", end: "18:15" },
        { date: "2026-01-29", start: "17:15", end: "18:15" },
        { date: "2026-02-05", start: "17:15", end: "18:15" },
        { date: "2026-02-12", start: "17:15", end: "18:15" },
        { date: "2026-02-19", start: "17:15", end: "18:15" },
        { date: "2026-02-23", start: "16:15", end: "17:15" },
        { date: "2026-03-05", start: "17:15", end: "18:15" },
        { date: "2026-03-09", start: "16:15", end: "17:15" },
        { date: "2026-03-12", start: "16:15", end: "17:15" },
        { date: "2026-03-16", start: "16:15", end: "17:15" },
        { date: "2026-03-23", start: "16:15", end: "17:15" },
        { date: "2026-03-27", start: "16:15", end: "17:15" },
        { date: "2026-04-13", start: "16:15", end: "17:15" },
        { date: "2026-04-16", start: "17:15", end: "18:15" },
        { date: "2026-04-20", start: "16:15", end: "17:15" },
        { date: "2026-04-23", start: "17:15", end: "18:15" },
        { date: "2026-04-27", start: "16:15", end: "17:15" },
        { date: "2026-04-30", start: "17:15", end: "18:15" },
        { date: "2026-05-04", start: "16:15", end: "17:15" },
        { date: "2026-05-07", start: "17:15", end: "18:15" },
        { date: "2026-05-11", start: "16:15", end: "17:15" },
        { date: "2026-05-14", start: "17:15", end: "18:15" },
        { date: "2026-05-18", start: "16:15", end: "17:15" },
        { date: "2026-05-21", start: "17:15", end: "18:15" },
        { date: "2026-05-25", start: "16:15", end: "17:15" },
        { date: "2026-05-28", start: "17:15", end: "18:15" }
    ];

    const HORARIOS = {
      Noa: [
        { date: "2025-09-16", start: "16:00", end: "17:30" },
        { date: "2025-09-23", start: "16:00", end: "17:30" },
        { date: "2025-09-30", start: "16:00", end: "17:30" },
        { date: "2025-10-07", start: "16:00", end: "17:30" },
        { date: "2025-10-14", start: "16:00", end: "17:30" },
        { date: "2025-10-21", start: "16:00", end: "17:30" },
        { date: "2025-10-28", start: "16:00", end: "17:30" },
        { date: "2025-11-25", start: "16:00", end: "17:30" },
        { date: "2025-12-05", start: "16:00", end: "17:30" },
        { date: "2025-12-09", start: "16:00", end: "17:30" },
        { date: "2025-12-16", start: "16:00", end: "17:30" },
        { date: "2026-01-13", start: "16:00", end: "17:30" },
        { date: "2026-01-27", start: "16:00", end: "17:30" },
        { date: "2026-02-06", start: "16:00", end: "17:30" },
        { date: "2026-02-13", start: "16:00", end: "17:30" },
        { date: "2026-02-20", start: "16:00", end: "17:30" },
        { date: "2026-02-27", start: "16:00", end: "17:30" },
        { date: "2026-03-06", start: "16:00", end: "17:30" },
        { date: "2026-03-13", start: "16:00", end: "17:30" },
        { date: "2026-03-17", start: "16:00", end: "17:30" },
        { date: "2026-03-24", start: "16:00", end: "17:30" },
        { date: "2026-04-14", start: "16:00", end: "17:30" },
        { date: "2026-04-21", start: "16:00", end: "17:30" },
        { date: "2026-04-28", start: "16:00", end: "17:30" },
        { date: "2026-05-05", start: "16:00", end: "17:30" },
        { date: "2026-05-12", start: "16:00", end: "17:30" },
        { date: "2026-05-19", start: "16:00", end: "17:30" },
        { date: "2026-05-26", start: "16:00", end: "17:30" }
      ],

      Jorge: [
        { date: "2025-09-17", start: "18:00", end: "19:00" },
        ],

      Adriana: [
        
        { date: "2025-09-17", start: "19:00", end: "20:00" },
        { date: "2025-09-24", start: "19:00", end: "20:00" },
        { date: "2025-10-01", start: "19:00", end: "20:00" },
        { date: "2025-10-08", start: "19:00", end: "20:00" },
        { date: "2025-10-15", start: "19:00", end: "20:00" },
        { date: "2025-10-22", start: "19:00", end: "20:00" },
        { date: "2025-10-29", start: "19:00", end: "20:00" },
        { date: "2025-11-05", start: "19:00", end: "20:00" },
        { date: "2025-12-03", start: "19:00", end: "20:00" },
        { date: "2025-12-10", start: "19:00", end: "20:00" },
        { date: "2026-01-07", start: "19:00", end: "20:00" },
        { date: "2026-01-21", start: "19:00", end: "20:00" },
        { date: "2026-01-28", start: "19:00", end: "20:00" },
        { date: "2026-02-04", start: "19:00", end: "20:00" },
        { date: "2026-02-11", start: "19:00", end: "20:00" },
        { date: "2026-02-18", start: "19:00", end: "20:00" },
        { date: "2026-02-25", start: "19:00", end: "20:00" },
        { date: "2026-03-04", start: "19:00", end: "20:00" },
        { date: "2026-03-11", start: "19:00", end: "20:00" },
        { date: "2026-03-18", start: "19:00", end: "20:00" },
        { date: "2026-03-25", start: "19:00", end: "20:00" },
        { date: "2026-04-15", start: "19:00", end: "20:00" },
        { date: "2026-04-22", start: "19:00", end: "20:00" },
        { date: "2026-04-29", start: "19:00", end: "20:00" },
        { date: "2026-05-06", start: "19:00", end: "20:00" },
        { date: "2026-05-13", start: "19:00", end: "20:00" },
        { date: "2026-05-20", start: "19:00", end: "20:00" },
        { date: "2026-05-27", start: "19:00", end: "20:00" }
      ],

      Lea: [
        { date: "2025-09-15", start: "16:15", end: "17:15" },
        { date: "2025-09-18", start: "17:15", end: "18:15" },
        { date: "2025-09-22", start: "16:15", end: "17:15" },
        { date: "2025-09-26", start: "16:15", end: "17:15" },
        { date: "2025-09-29", start: "16:15", end: "17:15" },
        { date: "2025-10-02", start: "17:15", end: "18:15" },
        { date: "2025-10-06", start: "16:15", end: "17:15" },
        { date: "2025-10-09", start: "17:15", end: "18:15" },
        { date: "2025-10-13", start: "16:15", end: "17:15" },
        { date: "2025-10-16", start: "17:15", end: "18:15" },
        { date: "2025-10-20", start: "16:15", end: "17:15" },
        { date: "2025-10-23", start: "17:15", end: "18:15" },
        { date: "2025-10-27", start: "16:15", end: "17:15" },
        { date: "2025-10-30", start: "17:15", end: "18:15" },
        { date: "2025-11-03", start: "16:15", end: "17:15" },
        { date: "2025-11-06", start: "17:15", end: "18:15" },
        { date: "2025-11-27", start: "17:15", end: "18:15" },
        { date: "2025-12-01", start: "16:15", end: "17:15" },
        { date: "2025-12-12", start: "16:15", end: "17:15" },
        { date: "2025-12-18", start: "17:15", end: "18:15" },
        { date: "2026-01-09", start: "16:15", end: "17:15" },
        { date: "2026-01-15", start: "17:15", end: "18:15" },
        { date: "2026-01-19", start: "16:15", end: "17:15" },
        { date: "2026-01-22", start: "17:15", end: "18:15" },
        { date: "2026-01-29", start: "17:15", end: "18:15" },
        { date: "2026-02-05", start: "17:15", end: "18:15" },
        { date: "2026-02-12", start: "17:15", end: "18:15" },
        { date: "2026-02-19", start: "17:15", end: "18:15" },
        { date: "2026-02-23", start: "16:15", end: "17:15" },
        { date: "2026-03-05", start: "17:15", end: "18:15" },
        { date: "2026-03-09", start: "16:15", end: "17:15" },
        { date: "2026-03-12", start: "16:15", end: "17:15" },
        { date: "2026-03-16", start: "16:15", end: "17:15" },
        { date: "2026-03-23", start: "16:15", end: "17:15" },
        { date: "2026-03-27", start: "16:15", end: "17:15" },
        { date: "2026-04-13", start: "16:15", end: "17:15" },
        { date: "2026-04-16", start: "17:15", end: "18:15" },
        { date: "2026-04-20", start: "16:15", end: "17:15" },
        { date: "2026-04-23", start: "17:15", end: "18:15" },
        { date: "2026-04-27", start: "16:15", end: "17:15" },
        { date: "2026-04-30", start: "17:15", end: "18:15" },
        { date: "2026-05-04", start: "16:15", end: "17:15" },
        { date: "2026-05-07", start: "17:15", end: "18:15" },
        { date: "2026-05-11", start: "16:15", end: "17:15" },
        { date: "2026-05-14", start: "17:15", end: "18:15" },
        { date: "2026-05-18", start: "16:15", end: "17:15" },
        { date: "2026-05-21", start: "17:15", end: "18:15" },
        { date: "2026-05-25", start: "16:15", end: "17:15" },
        { date: "2026-05-28", start: "17:15", end: "18:15" }

      ],

      Carla: [
        { date: "2025-09-18", start: "18:30", end: "19:30" },
        { date: "2025-09-25", start: "18:30", end: "19:30" },
        { date: "2025-10-02", start: "18:30", end: "19:30" },
        { date: "2025-10-09", start: "18:30", end: "19:30" },
        { date: "2025-10-16", start: "18:30", end: "19:30" },
        { date: "2025-10-23", start: "18:30", end: "19:30" },
        { date: "2025-10-30", start: "18:30", end: "19:30" },
        { date: "2025-11-06", start: "18:30", end: "19:30" },
        { date: "2025-12-01", start: "18:30", end: "19:30" },
        { date: "2025-12-18", start: "18:30", end: "19:30" },
        { date: "2026-01-19", start: "18:30", end: "19:30" },
        { date: "2026-01-29", start: "18:30", end: "19:30" },
        { date: "2026-02-12", start: "18:30", end: "19:30" },
        { date: "2026-02-23", start: "18:30", end: "19:30" },
        { date: "2026-03-02", start: "18:30", end: "19:30" },
        { date: "2026-03-09", start: "18:30", end: "19:30" },
        { date: "2026-03-16", start: "18:30", end: "19:30" },
        { date: "2026-03-23", start: "18:30", end: "19:30" },
        { date: "2026-04-09", start: "18:30", end: "19:30" },
        { date: "2026-04-16", start: "18:30", end: "19:30" },
        { date: "2026-04-23", start: "18:30", end: "19:30" },
        { date: "2026-04-30", start: "18:30", end: "19:30" },
        { date: "2026-05-07", start: "18:30", end: "19:30" },
        { date: "2026-05-14", start: "18:30", end: "19:30" },
        { date: "2026-05-21", start: "18:30", end: "19:30" },
        { date: "2026-05-28", start: "18:30", end: "19:30" }
        ],

      Paula: [
        { date: "2025-09-15", start: "18:30", end: "19:30" },
        { date: "2025-09-22", start: "18:30", end: "19:30" },
        { date: "2025-09-29", start: "18:30", end: "19:30" },
        { date: "2025-10-06", start: "18:30", end: "19:30" },
        { date: "2025-10-13", start: "18:30", end: "19:30" },
        { date: "2025-10-20", start: "18:30", end: "19:30" },
        { date: "2025-10-27", start: "18:30", end: "19:30" },
        { date: "2025-11-03", start: "18:30", end: "19:30" },
        { date: "2025-11-27", start: "18:30", end: "19:30" },
        { date: "2025-12-08", start: "18:30", end: "19:30" },
        { date: "2026-01-15", start: "18:30", end: "19:30" },
        { date: "2026-01-22", start: "18:30", end: "19:30" },
        { date: "2026-02-05", start: "18:30", end: "19:30" },
        { date: "2026-02-19", start: "18:30", end: "19:30" },
        { date: "2026-02-26", start: "18:30", end: "19:30" },        
        { date: "2026-03-05", start: "18:30", end: "19:30" },        
        { date: "2026-03-12", start: "18:30", end: "19:30" },        
        { date: "2026-03-19", start: "18:30", end: "19:30" },
        { date: "2026-03-26", start: "18:30", end: "19:30" },
        { date: "2026-04-13", start: "18:30", end: "19:30" },
        { date: "2026-04-20", start: "18:30", end: "19:30" },
        { date: "2026-04-27", start: "18:30", end: "19:30" },
        { date: "2026-05-04", start: "18:30", end: "19:30" },        
        { date: "2026-05-11", start: "18:30", end: "19:30" },        
        { date: "2026-05-18", start: "18:30", end: "19:30" },        
        { date: "2026-05-25", start: "18:30", end: "19:30" }    
      ]
    };


  /* ======= Lógica de render ======= */
const params = new URLSearchParams(window.location.search);
const alumno = params.get("alumno"); 
const profesor = alumno === "profesora";

// enlaces por alumno
const excelLinks = {
  "Noa": "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ5vkRS5KOg61InuLhh7cF2sN6yasI1QEi39ATK_IVDxZ-QSeiuXccm3nv7E3mTPcH_v4m_-6qoAmyc/pubhtml",
  "Adriana": "https://docs.google.com/spreadsheets/d/e/2PACX-1vT0wjJ-o9V82D_zD4CVVMi4YkEayM9jRdnYviLBnuu52npMJ1HRivD8TapY-yZNhGmp4QwmTobbHCAi/pubhtml",
  "Paula": "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0Eqz_OxY2ivgU-9lDrVm25p9Y1a4ykWJAUqtNIo2Y1Ol96X7lJNOSRLduCsHnQknBltJquaV9bf72/pubhtml",
  "Lea": "https://docs.google.com/spreadsheets/d/e/2PACX-1vRBKbAj1KPCueJHL5kY3aBznD03j2NrN0CRfXPuHGd_pODCwPURF9I0eyZOh8K4oOkiHf980fy1MbXy/pubhtml"
};

//  botón estilizado
if (alumno && excelLinks[alumno]) {
  document.getElementById("excelButtonContainer").innerHTML = `
    <button onclick="showExcel()" 
            style="
              background-color: #4CAF50; 
              color: white; 
              padding: 8px 16px; 
              font-size: 14px; 
              border: none; 
              border-radius: 6px; 
              cursor: pointer; 
              box-shadow: 0 2px 5px rgba(0,0,0,0.2);
              transition: 0.3s;
            "
            onmouseover="this.style.backgroundColor='#45a049'"
            onmouseout="this.style.backgroundColor='#4CAF50'"
    >
      Ver Excel de ${alumno}
    </button>
  `;
}

// función que muestra el excel debajo del calendario
function showExcel(){
  document.getElementById("excelContent").innerHTML = `
    <iframe src="${excelLinks[alumno]}" width="100%" height="600" frameborder="0" style="display:block;"></iframe>
  `;
}

// utilidades
function toMinutes(hhmm){ const [h,m]=hhmm.split(":").map(Number); return h*60 + m; }
function dayNumber(d){ const date=new Date(d); return date.getFullYear()*10000 + (date.getMonth()+1)*100 + date.getDate(); }
function addDays(date,n){ const d=new Date(date); d.setDate(d.getDate()+n); return d; }
function startOfWeek(date){ const d=new Date(date); const day=(d.getDay()||7); d.setHours(0,0,0,0); d.setDate(d.getDate()- (day-1)); return d; }
function fmtDateISO(d){ 
  const y=d.getFullYear(); 
  const m=String(d.getMonth()+1).padStart(2,'0'); 
  const day=String(d.getDate()).padStart(2,'0'); 
  return `${y}-${m}-${day}`;
}
function isToday(d){ const t=new Date(); return d.getFullYear()===t.getFullYear() && d.getMonth()===t.getMonth() && d.getDate()===t.getDate(); }

// comprueba solapamiento (misma fecha)
function overlaps(a, b){
  if(a.date !== b.date) return false;
  const a0 = toMinutes(a.start), a1 = toMinutes(a.end);
  const b0 = toMinutes(b.start), b1 = toMinutes(b.end);
  return a0 < b1 && b0 < a1;
}

// construye lista de eventos: incluye CLASES (bloques profe) + HORARIOS (franjas alumno)
function buildEventsForView(){
  const events = [];

  // 1) bloques CLASES (siempre se muestran)
  for(const c of CLASES){
    const alumnos = [];
    for(const nombre in HORARIOS){
      if(HORARIOS[nombre].some(ev => overlaps(ev, c))){
        alumnos.push(nombre);
      }
    }
    let title = "No disponible";
    if(profesor){
      title = alumnos.length ? "Clase de " + alumnos.join(" / ") : "No disponible";
    } else {
      title = "No disponible";
    }
    events.push({
      ...c,
      source: 'clase',
      alumnos,
      tuClase: false,
      title
    });
  }

  // 2) franjas HORARIOS (mostramos según vista)
  for(const nombre in HORARIOS){
    for(const h of HORARIOS[nombre]){
      if(profesor){
        events.push({
          ...h,
          source: 'horario',
          alumno: nombre,
          title: "Clase de " + nombre,
          tuClase: false
        });
      } else if(alumno === nombre){
        events.push({
          ...h,
          source: 'horario',
          alumno: nombre,
          title: "Clase de " + nombre,
          tuClase: true
        });
      }
    }
  }

  return events;
}

// settings y DOM
let dayStart = 8, dayEnd = 22;
const DAY_NAMES=["Lun","Mar","Mié","Jue","Vie","Sáb","Dom"];
const dayHeader = document.getElementById('dayHeader');
const grid = document.getElementById('grid');
const calendarRoot = document.getElementById('calendarRoot');
let anchorDate = new Date();

// pinta header + grid (manteniendo visibleDays consistente)
function render(){
  // título
  if(profesor) document.getElementById('headerTitle').textContent = "Horario de la profesora";
  else if(alumno) document.getElementById('headerTitle').textContent = "Horario de " + alumno;
  else document.getElementById('headerTitle').textContent = "Horario semanal";

  const weekStart = startOfWeek(anchorDate);
  const weekEnd = addDays(weekStart, 7);
  document.getElementById('goDate').value = fmtDateISO(anchorDate);

  const showWeekend = document.getElementById('toggleWeekend').checked;
  const visibleDays = showWeekend ? [0,1,2,3,4,5,6] : [0,1,2,3,4];

  // ajustar columnas del calendario

  calendarRoot.style.gridTemplateColumns = `80px repeat(${visibleDays.length}, 1fr)`;

  // HEADER
  dayHeader.innerHTML = '';
  const empty = document.createElement('div'); 
  empty.className='cell'; 
  empty.style.gridRow=1; 
  empty.style.gridColumn=1; 
  dayHeader.appendChild(empty);

  for(let i=0;i<visibleDays.length;i++){
    const dayOffset = visibleDays[i];
    const d = addDays(weekStart, dayOffset);
    const cell = document.createElement('div');
    cell.className = 'cell ' + (isToday(d) ? 'today' : '');
    cell.style.gridRow = 1;
    cell.style.gridColumn = i+2;
    cell.innerHTML = `<div>${DAY_NAMES[dayOffset]}</div><small>${d.toLocaleDateString(undefined,{day:'2-digit',month:'short'})}</small>`;
    dayHeader.appendChild(cell);
  }

  // GRID (horas + slots)
  grid.innerHTML = '';
  const totalRows = (dayEnd - dayStart) * 2;
  grid.style.gridTemplateRows = `repeat(${totalRows},30px)`;

  for(let r=0;r<totalRows;r++){
    if(r%2===0){
      const hourCell=document.createElement('div');
      hourCell.className='cell hour';
      hourCell.textContent=String(dayStart + r/2).padStart(2,'0')+':00';
      hourCell.style.gridRow=`${r+2} / span 2`; 
      hourCell.style.gridColumn=1;
      hourCell.style.display="flex"; 
      hourCell.style.alignItems="center"; 
      grid.appendChild(hourCell);
    }
    for(let c=0;c<visibleDays.length;c++){
      const slot=document.createElement('div'); 
      slot.className='cell slot';
      slot.style.gridRow=r+2; 
      slot.style.gridColumn=c+2; 
      grid.appendChild(slot);
    }
  }

  // PINTAR EVENTOS (CLASES + HORARIOS filtrados en buildEventsForView)
  const EVENTS = buildEventsForView();

  for(const ev of EVENTS){
    const evDate = new Date(ev.date);
    if(evDate < weekStart || evDate >= weekEnd) continue; // filtrar solo semana visible

    const dayIdx = (evDate.getDay() || 7) - 1; // 0=Mon..6=Sun
    const colIndex = visibleDays.indexOf(dayIdx);
    if(colIndex === -1) continue; // día oculto (fin de semana)

    // calcular filas con clamp vertical
    const evStartMin = toMinutes(ev.start);
    const evEndMin = toMinutes(ev.end);
    const dayStartMin = dayStart * 60;
    const dayEndMin = dayEnd * 60;
    if(evEndMin <= dayStartMin || evStartMin >= dayEndMin) continue; // fuera de vista

    const startClamped = Math.max(evStartMin, dayStartMin);
    const endClamped = Math.min(evEndMin, dayEndMin);
    const startRow = Math.floor((startClamped - dayStartMin) / 30) + 2;
    const endRow = Math.ceil((endClamped - dayStartMin) / 30) + 2;

    const el = document.createElement('div');
    // clases CSS según tipo
    let cls = 'event';
    if(ev.source === 'clase') cls += ' cat-clase';
    else if(ev.source === 'horario'){
      if(ev.tuClase) cls += ' tu-clase';
      else cls += ' alumno-clase';
    }
    el.className = cls;
    el.style.gridColumn = (colIndex + 2);
    el.style.gridRow = `${startRow} / ${endRow}`;

    // contenido
    let metaExtra = '';
    if(ev.source === 'clase' && profesor && ev.alumnos && ev.alumnos.length){
      metaExtra = `<div class="meta-small">${ev.alumnos.join(' / ')}</div>`;
    }
    if(ev.source === 'horario' && profesor){
      metaExtra = `<div class="meta-small">alumno: ${ev.alumno}</div>`;
    }

    el.innerHTML = `<div class="title">${ev.title}</div><div class="meta">${ev.start} – ${ev.end}</div>${metaExtra}`;
    grid.appendChild(el);
  }
}

// selects de horas y controles
function populateHourSelects(){
  const startSel=document.getElementById('startHour');
  const endSel=document.getElementById('endHour');
  startSel.innerHTML=''; endSel.innerHTML='';
  for(let h=0; h<=23; h++){
    const opt1=document.createElement('option'); opt1.value=h; opt1.textContent=String(h).padStart(2,'0')+':00'; startSel.appendChild(opt1);
    const opt2=document.createElement('option'); opt2.value=h; opt2.textContent=String(h).padStart(2,'0')+':00'; endSel.appendChild(opt2);
  }
  startSel.value = dayStart;
  endSel.value = dayEnd;
  startSel.addEventListener('change', ()=>{
    const v = parseInt(startSel.value);
    dayStart = Math.min(v, dayEnd-1);
    render();
  });
  endSel.addEventListener('change', ()=>{
    const v = parseInt(endSel.value);
    dayEnd = Math.max(v, dayStart+1);
    render();
  });
}

function attachControls(){
  document.getElementById('prev').addEventListener('click', ()=>{ anchorDate = addDays(anchorDate, -7); render(); });
  document.getElementById('next').addEventListener('click', ()=>{ anchorDate = addDays(anchorDate, 7); render(); });
  document.getElementById('today').addEventListener('click', ()=>{ anchorDate = new Date(); render(); });
  document.getElementById('goDate').addEventListener('change', (e)=>{
    const d = new Date(e.target.value + 'T00:00');
    if(!isNaN(d)) { anchorDate = d; render(); }
  });
  document.getElementById('toggleWeekend').addEventListener('change', ()=>{ render(); });
}

// init
populateHourSelects();
attachControls();
document.getElementById('goDate').value = fmtDateISO(anchorDate);
render();
setInterval(()=>{ render(); }, 60*1000);

</script>
</body>